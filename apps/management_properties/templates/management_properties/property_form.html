{% extends 'core/base.html' %}
{% load static %}

{% block title %}
    {% if object %}Editar{% else %}Nueva{% endif %} Propiedad
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'management_properties/css/properties.css' %}">
{% endblock %}

{% block content %}
<div class="form-header">
    <h1>{% if object %}Editar{% else %}Nueva{% endif %} Propiedad</h1>
    {% comment %} <a href="{% url 'properties:property_list' %}" class="btn-back">Volver</a> {% endcomment %}
</div>

<form method="post" class="property-form">
    {% csrf_token %}
    <div class="form-actions">
        <button type="submit" class="btn-save">Guardar</button>
        <a href="{% url 'properties:property_list' %}" class="btn-cancel">Cancelar</a>
    </div>
    
    {% if form.non_field_errors %}
    <div class="form-errors">
        {% for error in form.non_field_errors %}
            <div class="error-message">{{ error }}</div>
        {% endfor %}
    </div>
    {% endif %}
    
    <div class="form-sections">
        <div class="form-section">
            <h2>Información Principal</h2>
            <div class="form-grid">
                <div class="form-field">
                    <label for="{{ form.address.id_for_label }}">Dirección</label>
                    {{ form.address }}
                    {% if form.address.errors %}
                    <div class="field-errors">{{ form.address.errors }}</div>
                    {% endif %}
                </div>

                <div class="form-field">
                    <label for="{{ form.current_owner.id_for_label}}">Propietario</label>
                    {{ form.current_owner }}
                    {% if form.current_owner.help_text %}
                    <small class="help-text">{{ form.current_owner.help_text }}</small>
                    {% endif %}
                    {% if form.current_owner.errors %}
                        <div class="field-errors">{{ form.current_owner.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-field">
                    <label for="{{ form.property_type.id_for_label }}">Tipo de Propiedad</label>
                    {{ form.property_type }}
                    {% if form.property_type.errors %}
                    <div class="field-errors">{{ form.property_type.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-field">
                    <label for="{{ form.offer_type.id_for_label }}">Tipo de Oferta</label>
                    {{ form.offer_type }}
                    {% if form.offer_type.errors %}
                    <div class="field-errors">{{ form.offer_type.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-field">
                    <label for="{{ form.status.id_for_label }}">Estado</label>
                    {{ form.status }}
                    {% if form.status.errors %}
                    <div class="field-errors">{{ form.status.errors }}</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="form-section">
            <h2>Características</h2>
            <div class="form-grid">
                <div class="form-field">
                    <label for="{{ form.square_meters.id_for_label }}">Superficie (m²)</label>
                    {{ form.square_meters }}
                    {% if form.square_meters.errors %}
                    <div class="field-errors">{{ form.square_meters.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-field">
                    <label for="{{ form.bedrooms.id_for_label }}">Dormitorios</label>
                    {{ form.bedrooms }}
                    {% if form.bedrooms.errors %}
                    <div class="field-errors">{{ form.bedrooms.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-field">
                    <label for="{{ form.bathrooms.id_for_label }}">Baños</label>
                    {{ form.bathrooms }}
                    {% if form.bathrooms.errors %}
                    <div class="field-errors">{{ form.bathrooms.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-field">
                    <label for="{{ form.floor_number.id_for_label }}">Número de Piso</label>
                    {{ form.floor_number }}
                    {% if form.floor_number.errors %}
                    <div class="field-errors">{{ form.floor_number.errors }}</div>
                    {% endif %}
                </div>
            </div>
            
            <div class="checkbox-group">
                <div class="form-checkbox">
                    {{ form.has_parking }}
                    <label for="{{ form.has_parking.id_for_label }}">Estacionamiento</label>
                </div>
                <div class="form-checkbox">
                    {{ form.has_storage_unit }}
                    <label for="{{ form.has_storage_unit.id_for_label }}">Bodega</label>
                </div>
                <div class="form-checkbox">
                    {{ form.pets_allowed }}
                    <label for="{{ form.pets_allowed.id_for_label }}">Mascotas Permitidas</label>
                </div>
            </div>
        </div>

        <div class="form-section">
            <h2>Información Comercial</h2>
            <div class="form-grid">
                <div class="form-field">
                    <label for="{{ form.price.id_for_label }}">Precio</label>
                    {{ form.price }}
                    {% if form.price.errors %}
                    <div class="field-errors">{{ form.price.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-field">
                    <label for="{{ form.common_expenses.id_for_label }}">Gastos Comunes</label>
                    {{ form.common_expenses }}
                    {% if form.common_expenses.errors %}
                    <div class="field-errors">{{ form.common_expenses.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-field">
                    <label for="{{ form.date_published.id_for_label }}">Fecha de Publicación</label>
                    {{ form.date_published }}
                    {% if form.date_published.errors %}
                    <div class="field-errors">{{ form.date_published.errors }}</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="form-section">
            <h2>Descripción y Detalles</h2>
            <div class="form-field">
                <label for="{{ form.property_description.id_for_label }}">Descripción de la Propiedad</label>
                {{ form.property_description }}
                {% if form.property_description.errors %}
                <div class="field-errors">{{ form.property_description.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-field">
                <label for="{{ form.amenities.id_for_label }}">Servicios</label>
                {{ form.amenities }}
                {% if form.amenities.errors %}
                <div class="field-errors">{{ form.amenities.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-field">
                <label for="{{ form.requirements.id_for_label }}">Requisitos</label>
                {{ form.requirements }}
                {% if form.requirements.errors %}
                <div class="field-errors">{{ form.requirements.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-field">
                <label for="{{ form.comments.id_for_label }}">Comentarios Internos</label>
                {{ form.comments }}
                {% if form.comments.errors %}
                <div class="field-errors">{{ form.comments.errors }}</div>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn-save">Guardar</button>
        <a href="{% url 'properties:property_list' %}" class="btn-cancel">Cancelar</a>
    </div>
</form>
{% endblock %}